# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# DATABASE CONNECTION (TWO-URL PATTERN FOR RLS ENFORCEMENT)
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# CRITICAL: Use separate roles for runtime vs migrations to ensure RLS enforcement
#
# DATABASE_URL (app_user role):
#   - Used by: Prisma Client runtime (dev + prod)
#   - Role: app_user (non-superuser, RLS enforced)
#   - Privileges: SELECT, INSERT, UPDATE, DELETE on tenant-scoped tables only
#   - Format: postgresql://app_user:<PASSWORD>@<HOST>:5432/postgres
#
# MIGRATION_DATABASE_URL (postgres owner):
#   - Used by: Prisma Migrate, DDL operations, RLS policy creation
#   - Role: postgres (owner, can bypass RLS for schema changes)
#   - Format: postgresql://postgres.<PROJECT>:<PASSWORD>@<HOST>:5432/postgres
#
# To create app_user role:
#   1. Run SQL from: server/prisma/create-app-user.sql in Supabase SQL Editor
#   2. Replace <STRONG_PASSWORD> in SQL before running
#   3. Generate connection string using app_user credentials
#   4. Set DATABASE_URL to app_user connection (below)
#   5. Keep MIGRATION_DATABASE_URL as postgres owner
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

# Runtime connection (app_user - RLS enforced)
DATABASE_URL=postgresql://app_user:<PASSWORD>@<HOST>:5432/postgres

# Migration connection (postgres owner - DDL operations)
MIGRATION_DATABASE_URL=postgresql://postgres.<PROJECT>:<PASSWORD>@<HOST>:5432/postgres

# Server Configuration
NODE_ENV=development
PORT=3001
HOST=0.0.0.0

# JWT Secrets (CHANGE IN PRODUCTION)
JWT_ACCESS_SECRET=your-super-secret-access-key-change-me-in-production
JWT_REFRESH_SECRET=your-super-secret-refresh-key-change-me-in-production
JWT_ADMIN_ACCESS_SECRET=your-super-secret-admin-access-key-change-me
JWT_ADMIN_REFRESH_SECRET=your-super-secret-admin-refresh-key-change-me

# JWT Expiry
JWT_ACCESS_EXPIRY=15m
JWT_REFRESH_EXPIRY=7d

# AI (Gemini) - Server-side ONLY
GEMINI_API_KEY=your-gemini-api-key-here

# AI Budget & Usage Configuration (Phase 3B)
# Cost per 1000 tokens in USD (for gemini-1.5-flash)
AI_COST_PER_1K_TOKENS_USD=0.002

# Preflight token estimates for budget enforcement
AI_PREFLIGHT_TOKENS_INSIGHTS=1500
AI_PREFLIGHT_TOKENS_NEGOTIATION=2500

# Default budget for tenants without explicit ai_budgets row
AI_BUDGET_DEFAULT_TOKENS=50000
AI_BUDGET_DEFAULT_HARD_STOP=true

# CORS
CORS_ORIGIN=http://localhost:5173

# Feature Flags
KILL_SWITCH_ALL=false
